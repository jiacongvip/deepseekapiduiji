# AI API Gateway èšåˆå¹³å°éƒ¨ç½²ä¸ä½¿ç”¨æŒ‡å—

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº†å¦‚ä½•éƒ¨ç½²ã€é…ç½®åŠä½¿ç”¨ AI API Gateway èšåˆå¹³å°ã€‚è¯¥å¹³å°æ•´åˆäº† DeepSeekã€GLMã€Kimiã€Qwenã€Doubaoã€Yuanbao åŠç™¾åº¦ AI ç­‰å¤šä¸ªé€†å‘ API æœåŠ¡ï¼Œæä¾›ç»Ÿä¸€çš„ OpenAI æ ¼å¼æ¥å£ç®¡ç†å’Œè°ƒç”¨ã€‚

---

## ç›®å½•
1. [ç³»ç»Ÿæ¶æ„](#1-ç³»ç»Ÿæ¶æ„)
2. [éƒ¨ç½²å‰å‡†å¤‡](#2-éƒ¨ç½²å‰å‡†å¤‡)
3. [å®å¡”é¢æ¿éƒ¨ç½²ï¼ˆæ¨èï¼‰](#3-å®å¡”é¢æ¿éƒ¨ç½²æ¨è)
4. [é…ç½®è¯´æ˜](#4-é…ç½®è¯´æ˜)
5. [åŠŸèƒ½ä½¿ç”¨æŒ‡å—](#5-åŠŸèƒ½ä½¿ç”¨æŒ‡å—)
    - [åå°ç®¡ç†](#åå°ç®¡ç†)
    - [åœ¨çº¿èŠå¤©æµ‹è¯•](#åœ¨çº¿èŠå¤©æµ‹è¯•)
    - [API è°ƒç”¨æ–¹å¼](#api-è°ƒç”¨æ–¹å¼)
6. [å¸¸è§é—®é¢˜ (FAQ)](#6-å¸¸è§é—®é¢˜-faq)

---

## 1. ç³»ç»Ÿæ¶æ„

æœ¬ç³»ç»Ÿç”±ä»¥ä¸‹ç»„ä»¶æ„æˆï¼š
- **Gateway (ç½‘å…³)**: æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£è¯·æ±‚è·¯ç”±ã€Token æ³¨å…¥ã€ç»Ÿä¸€é‰´æƒåŠåå°ç®¡ç†ç•Œé¢ã€‚
- **é€†å‘ API æœåŠ¡**:
    - `deepseek-free-api` (DeepSeek)
    - `glm-free-api` (æ™ºè°± GLM)
    - `kimi-free-api` (æœˆä¹‹æš—é¢ Kimi)
    - `qwen-free-api` (é˜¿é‡Œé€šä¹‰åƒé—®)
    - `doubao-free-api` (å­—èŠ‚è±†åŒ…)
    - `yuanbao-free-api` (è…¾è®¯å…ƒå®)
    - `baidu-free-api` (ç™¾åº¦æœç´¢/DeepSeek-R1)
- **Docker Compose**: è´Ÿè´£æ‰€æœ‰æœåŠ¡çš„ç¼–æ’ä¸ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚

---

## 2. éƒ¨ç½²å‰å‡†å¤‡

- **æœåŠ¡å™¨**: ä¸€å°å®‰è£…äº† Linux ç³»ç»Ÿï¼ˆå¦‚ CentOS, Ubuntuï¼‰çš„æœåŠ¡å™¨ã€‚
- **ç¯å¢ƒ**:
    - **Docker**: å¿…é¡»å®‰è£…ã€‚
    - **Docker Compose**: å¿…é¡»å®‰è£…ã€‚
- **å®å¡”é¢æ¿ (æ¨è)**: å»ºè®®ä½¿ç”¨å®å¡”é¢æ¿è¿›è¡Œå¯è§†åŒ–æ–‡ä»¶ç®¡ç†å’Œåå‘ä»£ç†è®¾ç½®ã€‚

---

## 3. å®å¡”é¢æ¿éƒ¨ç½²ï¼ˆæ¨èï¼‰

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºç›®å½•
1. ç™»å½•å®å¡”é¢æ¿ã€‚
2. è¿›å…¥å·¦ä¾§ **ã€æ–‡ä»¶ã€‘** èœå•ã€‚
3. è¿›å…¥ `/www/wwwroot/` ç›®å½•ã€‚
4. æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå‘½åä¸º `ai-gateway`ã€‚

### ç¬¬äºŒæ­¥ï¼šä¸Šä¼ æ–‡ä»¶
1. è¿›å…¥ `/www/wwwroot/ai-gateway` ç›®å½•ã€‚
2. ç‚¹å‡» **ã€ä¸Šä¼ ã€‘**ï¼Œé€‰æ‹©æœ¬åœ°çš„ `release.zip` æ–‡ä»¶ä¸Šä¼ ã€‚
3. ä¸Šä¼ å®Œæˆåï¼Œå³é”®ç‚¹å‡» `release.zip`ï¼Œé€‰æ‹© **ã€è§£å‹ã€‘**ï¼Œç›´æ¥è§£å‹åˆ°å½“å‰ç›®å½•ã€‚

### ç¬¬ä¸‰æ­¥ï¼šä¸€é”®éƒ¨ç½²
1. ç‚¹å‡»å®å¡”å·¦ä¾§ **ã€ç»ˆç«¯ã€‘** èœå•ã€‚
2. å¤åˆ¶å¹¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
   ```bash
   cd /www/wwwroot/ai-gateway
   bash deploy-bt.sh
   ```
3. è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥ç¯å¢ƒã€æ„å»ºé•œåƒå¹¶å¯åŠ¨æœåŠ¡ã€‚å½“çœ‹åˆ° `âœ… éƒ¨ç½²æˆåŠŸï¼` å­—æ ·æ—¶ï¼Œè¯´æ˜æœåŠ¡å·²å¯åŠ¨ã€‚

### ç¬¬å››æ­¥ï¼šé…ç½®å¤–ç½‘è®¿é—®ï¼ˆåŸŸåç»‘å®šï¼‰
1. ç‚¹å‡»å·¦ä¾§ **ã€ç½‘ç«™ã€‘** -> **ã€æ·»åŠ ç«™ç‚¹ã€‘**ã€‚
2. **åŸŸå**: å¡«å†™ä½ çš„åŸŸåï¼ˆä¾‹å¦‚ `api.example.com`ï¼‰ã€‚
3. **PHPç‰ˆæœ¬**: é€‰æ‹© `çº¯é™æ€`ã€‚
4. åˆ›å»ºæˆåŠŸåï¼Œç‚¹å‡»è¯¥ç½‘ç«™çš„ **ã€è®¾ç½®ã€‘**ã€‚
5. é€‰æ‹© **ã€åå‘ä»£ç†ã€‘** -> **ã€æ·»åŠ åå‘ä»£ç†ã€‘**ï¼š
    - **ä»£ç†åç§°**: `gateway`
    - **ç›®æ ‡URL**: `http://127.0.0.1:8888`
    - **å‘é€åŸŸå**: `$host`
6. ä¿å­˜å³å¯ã€‚ç°åœ¨ä½ å¯ä»¥é€šè¿‡ `http://api.example.com` è®¿é—®ç®¡ç†åå°äº†ã€‚

---

## 4. é…ç½®è¯´æ˜

æ‰€æœ‰é…ç½®å‡é€šè¿‡ Web ç®¡ç†ç•Œé¢è¿›è¡Œï¼Œ**æ— éœ€æ‰‹åŠ¨ä¿®æ”¹é…ç½®æ–‡ä»¶**ã€‚

- **é…ç½®æ–‡ä»¶è·¯å¾„**: `/gateway/config.json` (è‡ªåŠ¨ç”Ÿæˆï¼Œè¯·å‹¿æ‰‹åŠ¨åˆ é™¤)
- **é»˜è®¤æ¨¡æ¿**: `/gateway/config.default.json` (ç”¨äºåˆå§‹åŒ–)

**æ•°æ®æŒä¹…åŒ–æœºåˆ¶**:
ç³»ç»Ÿå¯åŠ¨æ—¶ä¼šä¼˜å…ˆè¯»å– `config.json`ã€‚åªè¦ä¸åˆ é™¤è¯¥æ–‡ä»¶ï¼Œå³ä½¿æ›´æ–°ä»£ç æˆ–é‡å¯å®¹å™¨ï¼Œä½ ä¿å­˜çš„ Token å’Œ Cookie **æ°¸è¿œä¸ä¼šä¸¢å¤±**ã€‚

---

## 5. åŠŸèƒ½ä½¿ç”¨æŒ‡å—

### åå°ç®¡ç†
è®¿é—® `http://ä½ çš„IP:8888` æˆ– `http://ä½ çš„åŸŸå` è¿›å…¥ç®¡ç†åå°ã€‚

- **Token / Cookie é…ç½®**:
    - åœ¨å¯¹åº”æœåŠ¡çš„è¾“å…¥æ¡†ä¸­å¡«å…¥ä»å®˜ç½‘è·å–çš„ Refresh Token æˆ– Cookieã€‚
    - **ç™¾åº¦ (Baidu)**: æ”¯æŒç›´æ¥ç²˜è´´å®Œæ•´çš„ JSON æ ¼å¼ Cookie æˆ– `name=value` å­—ç¬¦ä¸²ã€‚
- **ä¿å­˜é…ç½®**: ç‚¹å‡»åº•éƒ¨çš„ **â€œä¿å­˜æ‰€æœ‰é…ç½®â€** æŒ‰é’®ï¼Œä¿®æ”¹å³æ—¶ç”Ÿæ•ˆï¼Œæ— éœ€é‡å¯æœåŠ¡ã€‚

### åœ¨çº¿èŠå¤©æµ‹è¯•
æ¯ä¸ªæœåŠ¡å¡ç‰‡å³ä¸Šè§’éƒ½æœ‰ä¸€ä¸ªç»¿è‰²çš„ **[ğŸ’¬ æµ‹è¯•èŠå¤©]** æŒ‰é’®ã€‚
1. ç‚¹å‡»æŒ‰é’®ï¼Œå¼¹å‡ºèŠå¤©çª—å£ã€‚
2. ç³»ç»Ÿä¼šè‡ªåŠ¨åŠ è½½è¯¥æœåŠ¡é…ç½®çš„ç¬¬ä¸€ä¸ªæ¨¡å‹ã€‚
3. ç›´æ¥è¾“å…¥é—®é¢˜å¹¶å‘é€ï¼Œå³å¯éªŒè¯ Token æ˜¯å¦æœ‰æ•ˆåŠæœåŠ¡æ˜¯å¦è¿é€šã€‚

### API è°ƒç”¨æ–¹å¼
æœ¬å¹³å°å®Œå…¨å…¼å®¹ OpenAI API æ ¼å¼ã€‚

- **Base URL**: `http://ä½ çš„åŸŸå/v1` (æˆ– `http://IP:8888/v1`)
- **API Key**: `sk-any-key` (ä»»æ„éç©ºå­—ç¬¦ä¸²ï¼ŒçœŸå®é‰´æƒç”±ç½‘å…³åå°é…ç½®çš„ Token æ¥ç®¡)

**ç¤ºä¾‹ (Python)**:
```python
from openai import OpenAI

client = OpenAI(
    base_url="http://api.example.com/v1",
    api_key="sk-any-key"
)

response = client.chat.completions.create(
    model="deepseek-chat",
    messages=[
        {"role": "user", "content": "ä½ å¥½ï¼ŒDeepSeek"}
    ],
    stream=True
)

for chunk in response:
    if chunk.choices[0].delta.content:
        print(chunk.choices[0].delta.content, end="")
```

**ç¤ºä¾‹ (CURL)**:
```bash
curl -X POST http://api.example.com/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk-any-key" \
  -d '{
    "model": "deepseek-chat",
    "messages": [{"role": "user", "content": "Hello!"}],
    "stream": true
  }'
```

---

## 6. å¸¸è§é—®é¢˜ (FAQ)

**Q: æ›´æ–°ä»£ç ä¼šè¦†ç›–æˆ‘çš„é…ç½®å—ï¼Ÿ**
A: **ä¸ä¼š**ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹ `config.json` æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™ä¿ç•™ï¼Œåªæ›´æ–°ç¨‹åºé€»è¾‘å’Œé»˜è®¤æ¨¡æ¿ã€‚

**Q: ä¸ºä»€ä¹ˆ DeepSeek æç¤º Authorization Failedï¼Ÿ**
A: è¯·æ£€æŸ¥åå° DeepSeek ä¸€æ çš„ Token æ˜¯å¦å·²å¡«å†™å¹¶ä¿å­˜ã€‚å¦‚æœæ˜¯æ–°éƒ¨ç½²ï¼Œé»˜è®¤ä¸ºç©ºã€‚

**Q: ç™¾åº¦æœåŠ¡ (DeepSeek-R1) å¦‚ä½•è·å– Cookieï¼Ÿ**
A: ç™»å½•ç™¾åº¦æœç´¢æˆ– Chat é¡µé¢ï¼ŒF12 æ‰“å¼€æ§åˆ¶å°ï¼Œæ‰¾åˆ°ç½‘ç»œè¯·æ±‚ä¸­çš„ Cookieï¼Œæˆ–è€…ä½¿ç”¨ Cookie-Editor æ’ä»¶å¯¼å‡º JSON æ ¼å¼ï¼Œç›´æ¥ç²˜è´´åˆ°åå°å³å¯ã€‚

**Q: æ”¯æŒå“ªäº›å®¢æˆ·ç«¯ï¼Ÿ**
A: æ”¯æŒæ‰€æœ‰å…¼å®¹ OpenAI åè®®çš„å®¢æˆ·ç«¯ï¼Œå¦‚ NextChat (ChatGPT-Next-Web), Cherry Studio, Chatbox, LobeChat ç­‰ã€‚

---
*Generated by AI Assistant on 2026-01-18*
